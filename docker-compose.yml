services:
  nekaise:
    build:
      context: .
      args:
        OPENCLAW_VERSION: ${OPENCLAW_VERSION:-2026.2.21-2}
        NEKAISE_VERSION: ${NEKAISE_VERSION:-1.0.0}
    image: opennekaise:${NEKAISE_VERSION:-latest}
    container_name: nekaise
    restart: unless-stopped
    stdin_open: true
    tty: true
    init: true
    environment:
      # Model selection
      - OPENCLAW_MODEL=${OPENCLAW_MODEL:-openai-codex/gpt-5.3-codex}
      # Channel secrets â€” set these in .env
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN:-}
      - SLACK_BOT_TOKEN=${SLACK_BOT_TOKEN:-}
      - SLACK_APP_TOKEN=${SLACK_APP_TOKEN:-}
      - DISCORD_BOT_TOKEN=${DISCORD_BOT_TOKEN:-}
      # Gateway
      - GATEWAY_TOKEN=${GATEWAY_TOKEN:-}
    volumes:
      # All user-writable state: config, workspace, memory, logs
      - ./data:/data
    ports:
      - "${GATEWAY_PORT:-18789}:18789"
